module.exports = {

"[project]/.next-internal/server/app/api/chat/route/actions.js [app-rsc] (server actions loader, ecmascript)": (function(__turbopack_context__) {

var { g: global, __dirname, m: module, e: exports } = __turbopack_context__;
{
}}),
"[externals]/next/dist/compiled/next-server/app-route-turbo.runtime.dev.js [external] (next/dist/compiled/next-server/app-route-turbo.runtime.dev.js, cjs)": (function(__turbopack_context__) {

var { g: global, __dirname, m: module, e: exports } = __turbopack_context__;
{
const mod = __turbopack_context__.x("next/dist/compiled/next-server/app-route-turbo.runtime.dev.js", () => require("next/dist/compiled/next-server/app-route-turbo.runtime.dev.js"));

module.exports = mod;
}}),
"[externals]/@opentelemetry/api [external] (@opentelemetry/api, cjs)": (function(__turbopack_context__) {

var { g: global, __dirname, m: module, e: exports } = __turbopack_context__;
{
const mod = __turbopack_context__.x("@opentelemetry/api", () => require("@opentelemetry/api"));

module.exports = mod;
}}),
"[externals]/next/dist/compiled/next-server/app-page-turbo.runtime.dev.js [external] (next/dist/compiled/next-server/app-page-turbo.runtime.dev.js, cjs)": (function(__turbopack_context__) {

var { g: global, __dirname, m: module, e: exports } = __turbopack_context__;
{
const mod = __turbopack_context__.x("next/dist/compiled/next-server/app-page-turbo.runtime.dev.js", () => require("next/dist/compiled/next-server/app-page-turbo.runtime.dev.js"));

module.exports = mod;
}}),
"[externals]/next/dist/server/app-render/work-unit-async-storage.external.js [external] (next/dist/server/app-render/work-unit-async-storage.external.js, cjs)": (function(__turbopack_context__) {

var { g: global, __dirname, m: module, e: exports } = __turbopack_context__;
{
const mod = __turbopack_context__.x("next/dist/server/app-render/work-unit-async-storage.external.js", () => require("next/dist/server/app-render/work-unit-async-storage.external.js"));

module.exports = mod;
}}),
"[externals]/next/dist/server/app-render/work-async-storage.external.js [external] (next/dist/server/app-render/work-async-storage.external.js, cjs)": (function(__turbopack_context__) {

var { g: global, __dirname, m: module, e: exports } = __turbopack_context__;
{
const mod = __turbopack_context__.x("next/dist/server/app-render/work-async-storage.external.js", () => require("next/dist/server/app-render/work-async-storage.external.js"));

module.exports = mod;
}}),
"[externals]/next/dist/server/app-render/after-task-async-storage.external.js [external] (next/dist/server/app-render/after-task-async-storage.external.js, cjs)": (function(__turbopack_context__) {

var { g: global, __dirname, m: module, e: exports } = __turbopack_context__;
{
const mod = __turbopack_context__.x("next/dist/server/app-render/after-task-async-storage.external.js", () => require("next/dist/server/app-render/after-task-async-storage.external.js"));

module.exports = mod;
}}),
"[externals]/stream [external] (stream, cjs)": (function(__turbopack_context__) {

var { g: global, __dirname, m: module, e: exports } = __turbopack_context__;
{
const mod = __turbopack_context__.x("stream", () => require("stream"));

module.exports = mod;
}}),
"[externals]/http [external] (http, cjs)": (function(__turbopack_context__) {

var { g: global, __dirname, m: module, e: exports } = __turbopack_context__;
{
const mod = __turbopack_context__.x("http", () => require("http"));

module.exports = mod;
}}),
"[externals]/url [external] (url, cjs)": (function(__turbopack_context__) {

var { g: global, __dirname, m: module, e: exports } = __turbopack_context__;
{
const mod = __turbopack_context__.x("url", () => require("url"));

module.exports = mod;
}}),
"[externals]/punycode [external] (punycode, cjs)": (function(__turbopack_context__) {

var { g: global, __dirname, m: module, e: exports } = __turbopack_context__;
{
const mod = __turbopack_context__.x("punycode", () => require("punycode"));

module.exports = mod;
}}),
"[externals]/https [external] (https, cjs)": (function(__turbopack_context__) {

var { g: global, __dirname, m: module, e: exports } = __turbopack_context__;
{
const mod = __turbopack_context__.x("https", () => require("https"));

module.exports = mod;
}}),
"[externals]/zlib [external] (zlib, cjs)": (function(__turbopack_context__) {

var { g: global, __dirname, m: module, e: exports } = __turbopack_context__;
{
const mod = __turbopack_context__.x("zlib", () => require("zlib"));

module.exports = mod;
}}),
"[externals]/util [external] (util, cjs)": (function(__turbopack_context__) {

var { g: global, __dirname, m: module, e: exports } = __turbopack_context__;
{
const mod = __turbopack_context__.x("util", () => require("util"));

module.exports = mod;
}}),
"[externals]/node:fs [external] (node:fs, cjs)": (function(__turbopack_context__) {

var { g: global, __dirname, m: module, e: exports } = __turbopack_context__;
{
const mod = __turbopack_context__.x("node:fs", () => require("node:fs"));

module.exports = mod;
}}),
"[externals]/node:stream [external] (node:stream, cjs)": (function(__turbopack_context__) {

var { g: global, __dirname, m: module, e: exports } = __turbopack_context__;
{
const mod = __turbopack_context__.x("node:stream", () => require("node:stream"));

module.exports = mod;
}}),
"[externals]/node:stream/web [external] (node:stream/web, cjs)": (function(__turbopack_context__) {

var { g: global, __dirname, m: module, e: exports } = __turbopack_context__;
{
const mod = __turbopack_context__.x("node:stream/web", () => require("node:stream/web"));

module.exports = mod;
}}),
"[externals]/fs [external] (fs, cjs)": (function(__turbopack_context__) {

var { g: global, __dirname, m: module, e: exports } = __turbopack_context__;
{
const mod = __turbopack_context__.x("fs", () => require("fs"));

module.exports = mod;
}}),
"[externals]/path [external] (path, cjs)": (function(__turbopack_context__) {

var { g: global, __dirname, m: module, e: exports } = __turbopack_context__;
{
const mod = __turbopack_context__.x("path", () => require("path"));

module.exports = mod;
}}),
"[externals]/os [external] (os, cjs)": (function(__turbopack_context__) {

var { g: global, __dirname, m: module, e: exports } = __turbopack_context__;
{
const mod = __turbopack_context__.x("os", () => require("os"));

module.exports = mod;
}}),
"[externals]/crypto [external] (crypto, cjs)": (function(__turbopack_context__) {

var { g: global, __dirname, m: module, e: exports } = __turbopack_context__;
{
const mod = __turbopack_context__.x("crypto", () => require("crypto"));

module.exports = mod;
}}),
"[project]/lib/mcp-client/index.ts [app-route] (ecmascript)": ((__turbopack_context__) => {
"use strict";

var { g: global, __dirname } = __turbopack_context__;
{
__turbopack_context__.s({
    "executeToolCall": (()=>executeToolCall),
    "initMCP": (()=>initMCP),
    "processQuery": (()=>processQuery)
});
var __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$openai$2f$index$2e$mjs__$5b$app$2d$route$5d$__$28$ecmascript$29$__$3c$locals$3e$__ = __turbopack_context__.i("[project]/node_modules/openai/index.mjs [app-route] (ecmascript) <locals>");
var __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$dotenv$2f$lib$2f$main$2e$js__$5b$app$2d$route$5d$__$28$ecmascript$29$__ = __turbopack_context__.i("[project]/node_modules/dotenv/lib/main.js [app-route] (ecmascript)");
(()=>{
    const e = new Error("Cannot find module '@mcp/client'");
    e.code = 'MODULE_NOT_FOUND';
    throw e;
})();
var __TURBOPACK__imported__module__$5b$externals$5d2f$os__$5b$external$5d$__$28$os$2c$__cjs$29$__ = __turbopack_context__.i("[externals]/os [external] (os, cjs)");
;
;
;
;
__TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$dotenv$2f$lib$2f$main$2e$js__$5b$app$2d$route$5d$__$28$ecmascript$29$__["default"].config();
const OPENAI_API_KEY = process.env.OPENAI_API_KEY;
const MODEL_NAME = "gpt-4o-mini";
if (!OPENAI_API_KEY) throw new Error("OPENAI_API_KEY is not set");
const openai = new __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$openai$2f$index$2e$mjs__$5b$app$2d$route$5d$__$28$ecmascript$29$__$3c$locals$3e$__["OpenAI"]({
    apiKey: OPENAI_API_KEY
});
let mcp = null;
let tools = [];
let connected = false;
async function initMCP(serverScriptPath) {
    if (mcp) {
        return;
    }
    mcp = new McpClient({
        isServer: false,
        logger: console
    });
    console.log(serverScriptPath);
    const transport = new StdioTransport({
        command: "npx",
        args: [
            "tsx",
            serverScriptPath,
            __TURBOPACK__imported__module__$5b$externals$5d2f$os__$5b$external$5d$__$28$os$2c$__cjs$29$__["default"].homedir()
        ]
    });
    mcp.connect(transport);
    const toolsResult = await mcp.listTools();
    tools = toolsResult.tools.map((tool)=>({
            type: "function",
            function: {
                name: tool.name,
                description: tool.description,
                parameters: tool.inputSchema
            }
        }));
    connected = true;
    console.log("MCP Connected with tools:", tools.map((t)=>t.function.name));
}
async function executeToolCall(toolCall) {
    const toolName = toolCall.function.name;
    const toolArgs = JSON.parse(toolCall.function.arguments || "{}");
    if (!mcp) {
        throw new Error("MCP client not initialized");
    }
    const result = await mcp.callTool({
        name: toolName,
        arguments: toolArgs
    });
    return {
        id: toolCall.id,
        name: toolName,
        arguments: toolArgs,
        result: result.content
    };
}
async function processQuery(messagesInput) {
    const messages = [
        {
            role: "system",
            content: "You are a helpful assistant that can use tools."
        },
        ...messagesInput
    ];
    const response = await openai.chat.completions.create({
        model: MODEL_NAME,
        max_tokens: 1000,
        messages,
        tools
    });
    const replyMessage = response.choices[0].message;
    const toolCalls = replyMessage.tool_calls || [];
    if (toolCalls.length > 0) {
        const toolResponses = [];
        for (const toolCall of toolCalls){
            const toolResponse = await executeToolCall(toolCall);
            toolResponses.push(toolResponse);
            messages.push({
                role: "assistant",
                content: null,
                tool_calls: [
                    toolCall
                ]
            });
            messages.push({
                role: "tool",
                content: toolResponse.result,
                tool_call_id: toolCall.id
            });
        }
        const followUp = await openai.chat.completions.create({
            model: MODEL_NAME,
            messages
        });
        return {
            reply: followUp.choices[0].message.content || "",
            toolCalls,
            toolResponses
        };
    }
    return {
        reply: replyMessage.content || "",
        toolCalls: [],
        toolResponses: []
    };
}
}}),
"[project]/app/api/chat/route.ts [app-route] (ecmascript)": ((__turbopack_context__) => {
"use strict";

var { g: global, __dirname } = __turbopack_context__;
{
// import { NextRequest, NextResponse } from "next/server";
// import { OpenAI } from "openai";
// import { OpenAIToolSet } from "composio-core";
// const toolset = new OpenAIToolSet();
// const client = new OpenAI({
//   apiKey: process.env.OPENAI_API_KEY,
// });
// export async function POST(req: NextRequest) {
//   const { messages } = await req.json();
//   const userQuery = messages[messages.length - 1]?.content;
//   if (!userQuery) {
//     return NextResponse.json(
//       { error: "No user query found in request" },
//       { status: 400 },
//     );
//   }
//   try {
//     const tools = await toolset.getTools({
//       // You can directly specify multiple apps like so, but doing so might
//       // result in > 128 tools, but openai limits on 128 tools
//       // apps: ["gmail", "slack"],
//       //
//       // Or, single apps like so:
//       // apps: ["gmail"],
//       //
//       // Or, directly specifying actions like so:
//       // actions: ["GMAIL_SEND_EMAIL", "SLACK_SENDS_A_MESSAGE_TO_A_SLACK_CHANNEL"],
//       // Gmail and Linear does not cross the tool limit of 128 when combined
//       // together as well
//       apps: ["gmail", "linear"],
//     });
//     console.log(
//       `[DEBUG]: Tools length: ${tools.length}. Errors out if greater than 128`,
//     );
//     const fullMessages = [
//       {
//         role: "system",
//         content: "You are a helpful assistant that can use tools.",
//       },
//       ...messages,
//     ];
//     const response = await client.chat.completions.create({
//       model: "gpt-4o-mini",
//       messages: fullMessages,
//       tools,
//       // tool_choice: "auto",
//     });
//     const aiMessage = response.choices[0].message;
//     const toolCalls = aiMessage.tool_calls || [];
//     if (toolCalls.length > 0) {
//       const toolResponses = [];
//       for (const toolCall of toolCalls) {
//         const res = await toolset.executeToolCall(toolCall);
//         toolResponses.push(res);
//         console.log("[DEBUG]: Executed tool call:", res);
//       }
//       return NextResponse.json({
//         role: "assistant",
//         content: "Successfully executed tool call(s) 🎉🎉",
//         toolResponses,
//       });
//     }
//     return NextResponse.json({
//       role: "assistant",
//       content: aiMessage.content || "Sorry... got no response from the server",
//     });
//   } catch (err) {
//     console.error(err);
//     return NextResponse.json(
//       { error: "Something went wrong!" },
//       { status: 500 },
//     );
//   }
// }
// ------ For Local Server MCP connection ------
__turbopack_context__.s({
    "POST": (()=>POST)
});
var __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2f$server$2e$js__$5b$app$2d$route$5d$__$28$ecmascript$29$__ = __turbopack_context__.i("[project]/node_modules/next/server.js [app-route] (ecmascript)");
var __TURBOPACK__imported__module__$5b$project$5d2f$lib$2f$mcp$2d$client$2f$index$2e$ts__$5b$app$2d$route$5d$__$28$ecmascript$29$__ = __turbopack_context__.i("[project]/lib/mcp-client/index.ts [app-route] (ecmascript)");
;
;
const SERVER_PATH = "C:/Users/adity/mcp-project/chat-mcp-server/custom-fs-mcp-server/build/index.js";
async function POST(req) {
    const { messages } = await req.json();
    const userQuery = messages[messages.length - 1]?.content;
    if (!userQuery) {
        return __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2f$server$2e$js__$5b$app$2d$route$5d$__$28$ecmascript$29$__["NextResponse"].json({
            error: "No query provided"
        }, {
            status: 400
        });
    }
    try {
        await (0, __TURBOPACK__imported__module__$5b$project$5d2f$lib$2f$mcp$2d$client$2f$index$2e$ts__$5b$app$2d$route$5d$__$28$ecmascript$29$__["initMCP"])(SERVER_PATH);
        const { reply, toolCalls, toolResponses } = await (0, __TURBOPACK__imported__module__$5b$project$5d2f$lib$2f$mcp$2d$client$2f$index$2e$ts__$5b$app$2d$route$5d$__$28$ecmascript$29$__["processQuery"])(messages);
        if (toolCalls.length > 0) {
            return __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2f$server$2e$js__$5b$app$2d$route$5d$__$28$ecmascript$29$__["NextResponse"].json({
                role: "assistant",
                content: "Successfully executed tool call(s) 🎉🎉",
                toolResponses
            });
        }
        return __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2f$server$2e$js__$5b$app$2d$route$5d$__$28$ecmascript$29$__["NextResponse"].json({
            role: "assistant",
            content: reply
        });
    } catch (err) {
        console.error("[MCP Error]", err);
        return __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2f$server$2e$js__$5b$app$2d$route$5d$__$28$ecmascript$29$__["NextResponse"].json({
            error: "Something went wrong"
        }, {
            status: 500
        });
    }
}
}}),

};

//# sourceMappingURL=%5Broot-of-the-server%5D__b2681d25._.js.map